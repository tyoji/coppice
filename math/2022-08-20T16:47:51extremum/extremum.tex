\documentclass[12pt,b5paper]{ltjsarticle}

%\usepackage[margin=15truemm, top=5truemm, bottom=5truemm]{geometry}
\usepackage[margin=10truemm]{geometry}

\usepackage{amsmath,amssymb}
%\pagestyle{headings}
\pagestyle{empty}

%\usepackage{listings,url}
%\renewcommand{\theenumi}{(\arabic{enumi})}

%\usepackage{graphicx}

%\usepackage{tikz}
%\usetikzlibrary {arrows.meta}
%\usepackage{wrapfig}	% required for `\wrapfigure' (yatex added)
%\usepackage{bm}	% required for `\bm' (yatex added)

% ルビを振る
\usepackage{luatexja-ruby}	% required for `\ruby'

%% 核Ker 像Im Hom を定義
%\newcommand{\Img}{\mathop{\mathrm{Im}}\nolimits}
%\newcommand{\Ker}{\mathop{\mathrm{Ker}}\nolimits}
%\newcommand{\Hom}{\mathop{\mathrm{Hom}}\nolimits}

%\DeclareMathOperator{\Rot}{rot}
%\DeclareMathOperator{\Div}{div}
%\DeclareMathOperator{\Grad}{grad}
%\DeclareMathOperator{\arcsinh}{arcsinh}
%\DeclareMathOperator{\arccosh}{arccosh}
%\DeclareMathOperator{\arctanh}{arctanh}



\begin{document}

\hrulefill
\textbf{ヘッセ行列}
\hrulefill

2変数関数$f(x,y)$のヘッセ行列$H(f)$は次のように定義される。
\begin{equation}
 H(f)=
  \begin{pmatrix}
   \frac{\partial^2 f}{\partial x\partial x} & \frac{\partial^2 f}{\partial x\partial y}\\
   \frac{\partial^2 f}{\partial y\partial x} & \frac{\partial^2 f}{\partial y\partial y}
  \end{pmatrix}
  =
  \begin{pmatrix}
   f_{xx} & f_{yx}\\
   f_{xy} & f_{yy}
  \end{pmatrix}
\end{equation}

2変数の偏微分を行う順序で$H(f)$の成分の場所が決まる。

ヘッセ行列の行列式を\ruby{Hessian}{ヘッシアン}という。
\begin{equation}
 \lvert H(f) \rvert = f_{xx}f_{yy}-(f_{xy})^2
\end{equation}

\hrulefill
\textbf{極値}
\hrulefill

関数$f(x,y)$の極値(極大値、極小値)の求め方

\begin{enumerate}
 \item $f_x(x,y)=f_y(x,y)=0$を満たす点$(a,b)$を求める。
 \item 上の条件を満たす点$(a,b)$について$\lvert H(f(a,b)) \rvert$を計算する。
       \begin{itemize}
        \item $\lvert H(f(a,b)) \rvert <0$ の時、$f(a,b)$は極値ではない。
        \item $\lvert H(f(a,b)) \rvert >0$ の時、$f(a,b)$は極値である。
       \end{itemize}
 \item $f_{xx}(a,b)$を計算する。
       \begin{itemize}
        \item $f_{xx}(a,b) >0$であれば、$f(a,b)$は極小値である。
        \item $f_{xx}(a,b) <0$であれば、$f(a,b)$は極大値である。
       \end{itemize}
\end{enumerate}
上記条件のどれかが0になる場合($\lvert H(f(a,b)) \rvert =0$や$f_{xx}(a,b) =0$)は
この方法では判定できない。

\hrulefill

\newpage

\hrulefill


次の関数の極値を求めよ。
\begin{equation}
 z=xy(3-x-y)
\end{equation}

$z$の偏導関数$z_x,z_y,z_{xx},z_{yy},z_{xy}$を求める。
\begin{align}
 z_x =& \frac{\partial}{\partial x} xy(3-x-y) = y(3-2x -y)\\
 z_y =& \frac{\partial}{\partial y} xy(3-x-y) = x(3-x -2y)\\
 z_{xx} =& \frac{\partial}{\partial x} \frac{\partial}{\partial x} xy(3-x-y) = -2y\\
 z_{yy} =& \frac{\partial}{\partial y} \frac{\partial}{\partial y} xy(3-x-y) = -2x\\
 z_{xy} =& \frac{\partial}{\partial y} \frac{\partial}{\partial x} xy(3-x-y) = 3-2x -2y
\end{align}

$z_x=z_y=0$となる座標を求める。
これを満たす点は次の4つ。
\begin{itemize}
 \item $y=0$ かつ $x=0$ を満たす点 $(0,0)$
 \item $y=0$ かつ $3-x-2y=0$ を満たす点 $(3,0)$
 \item $3-2x-y=0$ かつ $x=0$ を満たす点 $(0,3)$
 \item $3-2x-y=0$ かつ $3-x-2y=0$ を満たす点 $(1,1)$
\end{itemize}

この4点ｎ$(0,0),(3,0),(0,3),(1,1)$が極値の候補である。

ヘッセ行列式$H$は次のような式である。
\begin{equation}
 H=z_{xx}z_{yy}-(z_{xy})^2=(-2y)(-2x)-(3-2x-2y)^2
\end{equation}

$H(0,0)=-9<0$であるので点$(0,0)$は極値を持たない。

$H(3,0)=-9<0$であるので点$(3,0)$は極値を持たない。

$H(0,3)=-9<0$であるので点$(0,3)$は極値を持たない。

$H(1,1)=3>0$であるので点$(3,0)$は極値を持つ。
$z_{xx}(1,1)=-2<0$であるのでこの点で極大であり、
極大値は$z(1,1)=1$である。



\hrulefill

\newpage

\hrulefill


次の関数の極値を求めよ。
\begin{equation}
 z=e^{-x^2-y^2}(2x^2+y^2)
\end{equation}

$z$の偏導関数$z_x,z_y,z_{xx},z_{yy},z_{xy}$を求める。
\begin{align}
 z_x =& e^{-x^2-y^2}(-4x^3 -2xy^2 + 4x) = e^{-x^2-y^2}2x(-2x^2 -y^2 + 2)\\
 z_y =& e^{-x^2-y^2}(-4x^2y -2y^3 + 2y) = e^{-x^2-y^2}2y(-2x^2 -y^2 + 1)\\
 z_{xx} =& e^{-x^2-y^2}(8x^4 + 4x^2y^2 -8x^2 -12x^2 -2y^2 + 4)\\
 z_{yy} =& e^{-x^2-y^2}(8x^2y^2 + 4y^4 -4y^2 -4x^2 -6y^2 + 2)\\
 z_{xy} =& e^{-x^2-y^2}4xy(2x^2 + y^2 -3)
\end{align}

$z_x = z_y =0$を満たす点は
$(0,0),(0,1),(0,-1),(1,0),(-1,0)$
である。

ヘッセ行列式$H=z_{xx}z_{yy}-(z_{xy})^2$
を計算する。

%\begin{equation}
% H =
%  e^{2(-x^2-y^2)}
%  \left(
%  \begin{split}
%   (8x^4 + 4x^2y^2 -8x^2 -12x^2 -2y^2 + 4)(8x^2y^2 + 4y^4 -4y^2 -4x^2 -6y^2 + 2)\\
%   - (4xy(2x^2 + y^2 -3))^2
%  \end{split}
%  \right)
%\end{equation}


\begin{itemize}
 \item
      点$(0,0)$の場合
      \begin{equation}
       H(0,0)=e^{2(-0^2-0^2)} (4\cdot 2-0^2) >0
      \end{equation}
      である。
      $z_{xx}(0,0)=4>0$より点$(0,0)$で極小値を持つ。
      極小値は$z(0,0)=0$である。


 \item
      点$(0,1)$の場合
      \begin{equation}
       H(0,1)=e^{2(-0^2-1^2)} (2\cdot (-4) - 0^2) <0
      \end{equation}
      であるので極値ではない。

 \item
      点$(0,-1)$の場合
      \begin{equation}
       H(0,-1)=e^{2(-0^2-(-1)^2)} (2\cdot (-4) - 0^2) <0
      \end{equation}
      であるので極値ではない。


 \item
      点$(1,0)$の場合
      \begin{equation}
       H(1,0)=e^{2(-1^2-0^2)} ((-8)\cdot (-2) - 0^2) >0
      \end{equation}
      である。
      $z_{xx}(1,0)=\frac{-8}{e}<0$より点$(1,0)$で極大値を持つ。
      極大値は$z(1,0)=\frac{2}{e}$である。


 \item
      点$(-1,0)$の場合
      \begin{equation}
       H(-1,0)=e^{2(-(-1)^2-0^2)} ((-8)\cdot (-2) - 0^2) <0
      \end{equation}
      である。
      $z_{xx}(-1,0)=\frac{-8}{e}<0$より点$(-1,0)$で極大値を持つ。
      極大値は$z(-1,0)=\frac{2}{e}$である。



\end{itemize}






\end{document}

