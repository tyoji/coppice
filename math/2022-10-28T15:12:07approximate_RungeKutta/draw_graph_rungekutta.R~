#!/bin/env Rscript

# 刻み値time[1]と最大時刻time[2]
time<-c(0.1, 50)

#
# 二階微分方程式
# u'' = -sin u - Mu'
# u(0)=A, u'(0)=B
#

# 微分方程式のメイン関数
fn_main <- function(x,y,z) {
    return(z)
}

# 微分方程式のサブ関数
fn_sub <- function(x,y,z) {
    return(-sin(y)-M*z)
}

# Runge-Kutta method
r_k_method <- function(a,b) {

    u<-c(a)  # uの初期値
    v<-c(b)  # u'の初期値

    delta <- time[1]  # 刻み値

    for (i in c(1:floor(time[2]/delta))) {
        
        k <- fn_main(t[i+1], u[i], v[i])
        m <- fn_sub(t[i+1], u[i], v[i])

        k <- c(k, fn_main(t[i+1]+delta/2,u[i]+k[1]*delta/2,v[i]+m[1]*delta/2))
        m <- c(m, fn_sub(t[i+1]+delta/2,u[i]+k[1]*delta/2,v[i]+m[1]*delta/2))

        k <- c(k, fn_main(t[i+1]+delta/2,u[i]+k[2]*delta/2,v[i]+m[2]*delta/2))
        m <- c(m, fn_sub(t[i+1]+delta/2,u[i]+k[2]*delta/2,v[i]+m[2]*delta/2))

        k <- c(k, fn_main(t[i+1]+delta/2,u[i]+k[3]*delta,v[i]+m[3]*delta))
        m <- c(m, fn_sub(t[i+1]+delta/2,u[i]+k[3]*delta,v[i]+m[3]*delta))

        u[i+1] <- u[i] + k %*% c(1,2,2,1) * delta/6
        v[i+1] <- v[i] + m %*% c(1,2,2,1) * delta/6
        
    }

    ### Runge Kutta 法 とは無関係 
    e<-v^2/2-cos(u)  # E(t) = u'^2/2 - cos(u)
    ###

    return(c(u,e))  # 数値解 u と おまけのe
}


# 時間t のベクトル
t <- seq(0, time[2], by = time[1])

### 数値計算 ###
# 初期値 u(0)=2, u'(0)=0, 空気抵抗m=0
M<-0
A=matrix(r_k_method(2, 0), ncol=2)
u_1 <- A[,1]
e_1 <- A[,2]

# 初期値 u(0)=2, u'(0)=0, 空気抵抗m=0.2
M<-0.2
A=matrix(r_k_method(2, 0), ncol=2)
u_2 <- A[,1]
e_2 <- A[,2]

# 初期値 u(0)=2, u'(0)=1.5, 空気抵抗m=0.2
M<-0.2
#u31<-r_k_method(2,1.5)
A=matrix(r_k_method(2, 1.5), ncol=2)
u_3 <- A[,1]
e_3 <- A[,2]


### C言語にて計算した結果
#u1 <- c(2.0,1.995452,1.981789,1.958956,1.926865,1.885399,1.834423,1.773793,1.703371,1.623040,1.532728,1.432431,1.322240,1.202369,1.073184,0.935228,0.789243,0.636176,0.477185,0.313614,0.146967,-0.021139,-0.189034,-0.355057,-0.517613,-0.675236,-0.826624,-0.970673,-1.106487,-1.233376,-1.350843,-1.458563,-1.556356,-1.644157,-1.721990,-1.789940,-1.848131,-1.896705,-1.935803,-1.965559,-1.986081,-1.997450,-1.999713,-1.992878,-1.976918,-1.951768,-1.917334,-1.873492,-1.820105,-1.757027,-1.684125,-1.601291,-1.508468,-1.405672,-1.293024,-1.170772,-1.039325,-0.899274,-0.751412,-0.596741,-0.436465,-0.271975,-0.104807,0.063404,0.230984,0.396281,0.557730,0.713901,0.863542,1.005598,1.139227,1.263788,1.378831,1.484069,1.579354,1.664646,1.739986,1.805472,1.861233,1.907412,1.944152,1.971579,1.989795,1.998873,1.998851,1.989728,1.971467,1.943995,1.907209,1.860983,1.805174,1.739640,1.664251,1.578911,1.483577,1.378290,1.263200,1.138593,1.004921,0.862825,0.713150,0.556950,0.395478,0.230166,0.062579,-0.105631,-0.272790,-0.437263,-0.597514,-0.752155,-0.899981,-1.039991,-1.171394,-1.293600,-1.406200,-1.508947,-1.601721,-1.684506,-1.757360,-1.820390,-1.873730,-1.917525,-1.951914,-1.977018,-1.992933,-1.999723,-1.997415,-1.986001,-1.965434,-1.935633,-1.896488,-1.847868,-1.789630,-1.721631,-1.643749,-1.555899,-1.458057,-1.350288,-1.232774,-1.105840,-0.969984,-0.825896,-0.674474,-0.516824,-0.354247,-0.188212,-0.020311,0.147792,0.314427,0.477979,0.636944,0.789978,0.935927,1.073841,1.202981,1.322805,1.432948,1.533195,1.623458,1.703740,1.774114,1.834696,1.885625,1.927044,1.959089,1.981877,1.995495,1.999998,1.995405,1.981697,1.958819,1.926681,1.885169,1.834146,1.773468,1.702997,1.622617,1.532255,1.431909,1.321670,1.201752,1.072522,0.934525,0.788502,0.635403,0.476386,0.312796,0.146138,-0.021971,-0.189861,-0.355870,-0.518406,-0.676000,-0.827355,-0.971365,-1.107136,-1.233980,-1.351399,-1.459070,-1.556814,-1.644565,-1.722349,-1.790251,-1.848394,-1.896920,-1.935972,-1.965681,-1.986158,-1.997482,-1.999699,-1.992819,-1.976814,-1.951619,-1.917138,-1.873249,-1.819814,-1.756688,-1.683737,-1.600853,-1.507980,-1.405136,-1.292439,-1.170140,-1.038649,-0.898557,-0.750659,-0.595957,-0.435657,-0.271149,-0.103972,0.064240,0.231812,0.397094,0.558520,0.714662,0.864267,1.006283,1.139868,1.264383,1.379378,1.484567,1.579802,1.665044,1.740335,1.805772,1.861485,1.907617,1.944310,1.971690,1.989861,1.998894,1.998826,1.989658,1.971351,1.943833,1.907000,1.860726,1.804870,1.739287,1.663849,1.578458,1.483075,1.377739,1.262600,1.137946,1.004231,0.862095,0.712385,0.556155,0.394660,0.229333,0.061739,-0.106470,-0.273620,-0.438075,-0.598302,-0.752911,-0.900700,-1.040669,-1.172028,-1.294186,-1.406738,-1.509434,-1.602159,-1.684894,-1.757698,-1.820679,-1.873971,-1.917719,-1.952061,-1.977118,-1.992988,-1.999732,-1.997379,-1.985919,-1.965306,-1.935458,-1.896266,-1.847598,-1.789311,-1.721263,-1.643332,-1.555431,-1.457540,-1.349722,-1.232159,-1.105179,-0.969279,-0.825152,-0.673697,-0.516018,-0.353420,-0.187371,-0.019466,0.148634,0.315257,0.478790,0.637729,0.790730,0.936640,1.074511,1.203606,1.323382,1.433475,1.533673,1.623885,1.704117,1.774442,1.834975,1.885855,1.927227,1.959225,1.981967,1.995538,1.999996,1.995357,1.981603,1.958678,1.926494,1.884934,1.833863,1.773136,1.702615,1.622184,1.531773,1.431376,1.321088,1.201122,1.071846,0.933806,0.787745,0.634614,0.475570,0.311961,0.145292,-0.022821,-0.190705,-0.356701,-0.519214,-0.676781,-0.828100,-0.972071,-1.107799,-1.234596,-1.351967,-1.459588,-1.557281,-1.644982,-1.722716,-1.790568,-1.848662,-1.897139,-1.936143,-1.965806,-1.986236,-1.997514,-1.999685,-1.992760,-1.976708,-1.951466,-1.916938,-1.873001,-1.819517,-1.756342,-1.683340,-1.600406,-1.507483,-1.404588,-1.291841,-1.169495,-1.037958,-0.897825,-0.749890,-0.595156,-0.434831,-0.270306,-0.103119,0.065094,0.232658,0.397924,0.559327,0.715438,0.865007,1.006982,1.140523,1.264990,1.379936,1.485074,1.580258,1.665450,1.740690,1.806078,1.861741,1.907825,1.944471,1.971804,1.989928,1.998915,1.998801,1.989586,1.971232,1.943667,1.906787,1.860465,1.804559,1.738926,1.663437,1.577996,1.482562,1.377175,1.261987,1.
#u2 <- c(2.000000,1.995482,1.982029,1.959765,1.928778,1.889130,1.840863,1.784010,1.718608,1.644711,1.562407,1.471840,1.373221,1.266858,1.153166,1.032688,0.906109,0.774259,0.638111,0.498776,0.357474,0.215514,0.074254,-0.064942,-0.200741,-0.331881,-0.457206,-0.575687,-0.686442,-0.788738,-0.881995,-0.965771,-1.039752,-1.103739,-1.157624,-1.201380,-1.235040,-1.258689,-1.272451,-1.276478,-1.270954,-1.256082,-1.232093,-1.199245,-1.157825,-1.108162,-1.050628,-0.985648,-0.913708,-0.835362,-0.751233,-0.662021,-0.568498,-0.471504,-0.371940,-0.270756,-0.168932,-0.067462,0.032665,0.130487,0.225085,0.315604,0.401262,0.481361,0.555297,0.622555,0.682714,0.735440,0.780486,0.817679,0.846916,0.868162,0.881435,0.886809,0.884408,0.874400,0.856999,0.832463,0.801095,0.763243,0.719301,0.669712,0.614964,0.555594,0.492183,0.425354,0.355767,0.284114,0.211108,0.137476,0.063946,-0.008759,-0.079938,-0.148918,-0.215065,-0.277792,-0.336564,-0.390907,-0.440405,-0.484706,-0.523521,-0.556621,-0.583840,-0.605066,-0.620244,-0.629371,-0.632493,-0.629705,-0.621145,-0.606997,-0.587485,-0.562876,-0.533476,-0.499627,-0.461708,-0.420134,-0.375349,-0.327824,-0.278056,-0.226558,-0.173858,-0.120491,-0.066992,-0.013890,0.038297,0.089073,0.137963,0.184525,0.228351,0.269069,0.306352,0.339913,0.369512,0.394952,0.416081,0.432794,0.445027,0.452759,0.456010,0.454840,0.449346,0.439664,0.425963,0.408446,0.387346,0.362927,0.335480,0.305320,0.272783,0.238226,0.202018,0.164543,0.126190,0.087351,0.048419,0.009779,-0.028193,-0.065135,-0.100700,-0.134568,-0.166437,-0.196037,-0.223124,-0.247486,-0.268941,-0.287344,-0.302579,-0.314564,-0.323251,-0.328623,-0.330697,-0.329517,-0.325159,-0.317727,-0.307352,-0.294189,-0.278418,-0.260241,-0.239879,-0.217569,-0.193566,-0.168135,-0.141553,-0.114101,-0.086067,-0.057737,-0.029398,-0.001329,0.026197,0.052920,0.078589,0.102974,0.125859,0.147050,0.166371,0.183672,0.198823,0.211720,0.222283,0.230456,0.236208,0.239531,0.240440,0.238977,0.235200,0.229193,0.221057,0.210913,0.198899,0.185169,0.169889,0.153239,0.135409,0.116596,0.097005,0.076844,0.056323,0.035651,0.015036,-0.005319,-0.025219,-0.044475,-0.062911,-0.080359,-0.096668,-0.111699,-0.125329,-0.137453,-0.147982,-0.156844,-0.163985,-0.169369,-0.172980,-0.174816,-0.174896,-0.173252,-0.169936,-0.165012,-0.158561,-0.150676,-0.141461,-0.131035,-0.119522,-0.107058,-0.093784,-0.079846,-0.065395,-0.050584,-0.035566,-0.020493,-0.005517,0.009218,0.023570,0.037404,0.050595,0.063024,0.074584,0.085178,0.094721,0.103139,0.110372,0.116372,0.121104,0.124548,0.126695,0.127549,0.127128,0.125461,0.122589,0.118564,0.113449,0.107316,0.100244,0.092322,0.083645,0.074314,0.064433,0.054110,0.043457,0.032585,0.021606,0.010631,-0.000232,-0.010878,-0.021205,-0.031118,-0.040527,-0.049349,-0.057508,-0.064937,-0.071577,-0.077378,-0.082300,-0.086311,-0.089389,-0.091524,-0.092712,-0.092961,-0.092287,-0.090714,-0.088276,-0.085015,-0.080978,-0.076221,-0.070804,-0.064795,-0.058265,-0.051288,-0.043942,-0.036306,-0.028463,-0.020494,-0.012480,-0.004501,0.003365,0.011041,0.018457,0.025543,0.032236,0.038477,0.044215,0.049401,0.053997,0.057967,0.061286,0.063933,0.065896,0.067168,0.067751,0.067654,0.066889,0.065478,0.063448,0.060831,0.057664,0.053990,0.049854,0.045308,0.040404,0.035197,0.029745,0.024107,0.018342,0.012510,0.006670,0.000879,-0.004806,-0.010331,-0.015644,-0.020697,-0.025445,-0.029848,-0.033868,-0.037474,-0.040638,-0.043337,-0.045554,-0.047277,-0.048498,-0.049215,-0.049431,-0.049155,-0.048398,-0.047177,-0.045514,-0.043434,-0.040965,-0.038140,-0.034994,-0.031564,-0.027890,-0.024012,-0.019974,-0.015819,-0.011589,-0.007328,-0.003079,0.001116,0.005217,0.009185,0.012984,0.016579,0.019939,0.023036,0.025843,0.028338,0.030505,0.032326,0.033792,0.034894,0.035630,0.035998,0.036004,0.035653,0.034956,0.033928,0.032584,0.030944,0.029031,0.026869,0.024484,0.021904,0.019158,0.016277,0.013292,0.010235,0.007137,0.004030,0.000944,-0.002090,-0.005043,-0.007887,-0.010598,-0.013149,-0.015521,-0.017691,-0.019644,-0.021364,-0.022838,-0.024058,-0.025015,-0.025706,-0.026129,-0.026285,-0.026178,-0.025814,-0.025202,-0.024353,-0.023279,-0.021997,
#u3 <- c(2.000000,2.144103,2.277045,2.399827,2.513494,2.619094,2.717663,2.810207,2.897697,2.981064,3.061197,3.138947,3.215132,3.290537,3.365917,3.442009,3.519524,3.599158,3.681591,3.767482,3.857472,3.952178,4.052181,4.158022,4.270180,4.389059,4.514962,4.648069,4.788405,4.935817,5.089944,5.250201,5.415766,5.585581,5.758373,5.932689,6.106942,6.279474,6.448626,6.612804,6.770535,6.920520,7.061657,7.193063,7.314065,7.424191,7.523149,7.610792,7.687098,7.752135,7.806039,7.848988,7.881188,7.902853,7.914200,7.915440,7.906773,7.888390,7.860476,7.823215,7.776798,7.721432,7.657353,7.584837,7.504220,7.415907,7.320385,7.218242,7.110166,6.996956,6.879517,6.758853,6.636054,6.512272,6.388698,6.266529,6.146945,6.031070,5.919955,5.814552,5.715700,5.624120,5.540408,5.465042,5.398388,5.340708,5.292175,5.252879,5.222847,5.202044,5.190387,5.187748,5.193961,5.208822,5.232090,5.263487,5.302693,5.349342,5.403022,5.463264,5.529545,5.601282,5.677832,5.758493,5.842510,5.929081,6.017365,6.106499,6.195606,6.283812,6.370266,6.454149,6.534688,6.611171,6.682955,6.749469,6.810219,6.864792,6.912850,6.954131,6.988443,7.015663,7.035728,7.048633,7.054426,7.053208,7.045126,7.030373,7.009189,6.981855,6.948699,6.910092,6.866445,6.818214,6.765895,6.710021,6.651159,6.589905,6.526877,6.462711,6.398051,6.333537,6.269803,6.207463,6.147105,6.089285,6.034515,5.983264,5.935950,5.892938,5.854542,5.821017,5.792566,5.769341,5.751438,5.738906,5.731745,5.729909,5.733309,5.741811,5.755243,5.773393,5.796012,5.822813,5.853479,5.887659,5.924974,5.965018,6.007363,6.051563,6.097159,6.143681,6.190657,6.237617,6.284098,6.329649,6.373839,6.416258,6.456525,6.494289,6.529232,6.561075,6.589572,6.614522,6.635760,6.653162,6.666641,6.676153,6.681687,6.683274,6.680975,6.674890,6.665148,6.651912,6.635372,6.615748,6.593282,6.568243,6.540917,6.511611,6.480646,6.448353,6.415073,6.381152,6.346934,6.312764,6.278979,6.245903,6.213852,6.183120,6.153985,6.126701,6.101500,6.078584,6.058132,6.040293,6.025186,6.012903,6.003504,5.997022,5.993461,5.992796,5.994977,5.999927,6.007544,6.017702,6.030255,6.045035,6.061856,6.080515,6.100796,6.122470,6.145297,6.169032,6.193424,6.218220,6.243167,6.268015,6.292522,6.316451,6.339577,6.361688,6.382585,6.402087,6.420029,6.436266,6.450674,6.463147,6.473602,6.481978,6.488235,6.492353,6.494336,6.494206,6.492006,6.487800,6.481666,6.473704,6.464025,6.452760,6.440047,6.426042,6.410905,6.394807,6.377927,6.360445,6.342546,6.324414,6.306234,6.288186,6.270445,6.253182,6.236557,6.220723,6.205820,6.191976,6.179308,6.167916,6.157888,6.149294,6.142191,6.136619,6.132602,6.130148,6.129251,6.129889,6.132024,6.135607,6.140574,6.146848,6.154343,6.162960,6.172593,6.183127,6.194440,6.206407,6.218895,6.231771,6.244901,6.258150,6.271384,6.284472,6.297289,6.309712,6.321627,6.332926,6.343509,6.353286,6.362177,6.370111,6.377029,6.382883,6.387637,6.391265,6.393754,6.395103,6.395320,6.394425,6.392450,6.389436,6.385432,6.380498,6.374700,6.368113,6.360817,6.352899,6.344448,6.335559,6.326328,6.316853,6.307233,6.297566,6.287947,6.278472,6.269232,6.260312,6.251795,6.243757,6.236269,6.229392,6.223184,6.217692,6.212956,6.209008,6.205871,6.203560,6.202082,6.201435,6.201608,6.202584,6.204337,6.206835,6.210037,6.213900,6.218370,6.223393,6.228908,6.234850,6.241152,6.247745,6.254558,6.261520,6.268558,6.275601,6.282580,6.289426,6.296075,6.302465,6.308538,6.314240,6.319522,6.324340,6.328655,6.332435,6.335654,6.338290,6.340329,6.341762,6.342588,6.342810,6.342439,6.341489,6.339981,6.337942,6.335402,6.332395,6.328962,6.325144,6.320986,6.316537,6.311847,6.306965,6.301945,6.296839,6.291699,6.286577,6.281522,6.276584,6.271809,6.267241,6.262921,6.258888,6.255174,6.251811,6.248825,6.246238,6.244068,6.242327,6.241025,6.240166,6.239749,6.239770,6.240220,6.241085,6.242351,6.243994,6.245993,6.248321,6.250946,6.253839,6.256965,6.260288,6.263772,6.267379,6.271071,6.274810,6.278557,6.282276,6.285930,6.289485,6.292907,6.296166,6.299231,6.302077,6.304679,6.307018,6.309074,6.310834,6.312285,6.313420,6.314233,6.314723,6.314892,6.314743,6.314286,6.313529,6.312488,6.311177,6.309616,6.307824,6.305823,6.303639,6.301295,6.298819,
#
#e1 <- c(2.000000,0.416147,0.416147,0.416147,0.416147,0.416147,0.416147,0.416147,0.416147,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416147,0.416147,0.416147,0.416147,0.416147,0.416147,0.416147,0.416147,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416147,0.416147,0.416147,0.416147,0.416146,0.416146,0.416146,0.416146,0.416145,0.416145,0.416145,0.416145,0.416145,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416146,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416146,0.416146,0.416146,0.416146,0.416146,0.416145,0.416145,0.416145,0.416145,0.416145,0.416144,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416144,0.416144,0.416144,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416145,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416145,0.416145,0.416144,0.416144,0.416144,0.416144,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416144,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416144,0.416144,0.416144,0.416144,0.416143,0.416143,0.416143,0.416143,0.416142,0.416142,0.416142,0.416142,0.416142,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416143,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416143,0.416143,0.416143,0.416143,0.416143,0.416142,0.416142,0.416142,0.416142,0.416142,0.416141,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,0.416142,
#e2 <- c(2.000000,0.416092,0.415717,0.414713,0.412780,0.409624,0.404952,0.398475,0.389908,0.378974,0.365415,0.348999,0.329537,0.306901,0.281041,0.252005,0.219955,0.185182,0.148108,0.109278,0.069345,0.029040,-0.010869,-0.049621,-0.086507,-0.120907,-0.152326,-0.180411,-0.204955,-0.225897,-0.243305,-0.257357,-0.268320,-0.276526,-0.282350,-0.286196,-0.288479,-0.289614,-0.290009,-0.290057,-0.290133,-0.290589,-0.291754,-0.293924,-0.297367,-0.302311,-0.308941,-0.317395,-0.327753,-0.340035,-0.354195,-0.370117,-0.387612,-0.406430,-0.426256,-0.446733,-0.467469,-0.488061,-0.508113,-0.527252,-0.545152,-0.561543,-0.576222,-0.589060,-0.599999,-0.609055,-0.616302,-0.621871,-0.625940,-0.628717,-0.630437,-0.631350,-0.631713,-0.631781,-0.631803,-0.632012,-0.632627,-0.633839,-0.635814,-0.638686,-0.642554,-0.647477,-0.653475,-0.660528,-0.668572,-0.677506,-0.687192,-0.697461,-0.708121,-0.718964,-0.729777,-0.740350,-0.750483,-0.760001,-0.768753,-0.776625,-0.783536,-0.789446,-0.794350,-0.798280,-0.801299,-0.803495,-0.804983,-0.805890,-0.806357,-0.806530,-0.806555,-0.806576,-0.806728,-0.807134,-0.807900,-0.809115,-0.810847,-0.813142,-0.816020,-0.819479,-0.823492,-0.828010,-0.832964,-0.838269,-0.843823,-0.849519,-0.855244,-0.860883,-0.866331,-0.871487,-0.876269,-0.880606,-0.884449,-0.887766,-0.890549,-0.892804,-0.894559,-0.895856,-0.896752,-0.897314,-0.897617,-0.897740,-0.897764,-0.897770,-0.897833,-0.898024,-0.898402,-0.899018,-0.899910,-0.901104,-0.902612,-0.904433,-0.906551,-0.908940,-0.911562,-0.914371,-0.917313,-0.920330,-0.923361,-0.926348,-0.929232,-0.931961,-0.934491,-0.936786,-0.938818,-0.940571,-0.942040,-0.943228,-0.944150,-0.944829,-0.945295,-0.945584,-0.945737,-0.945796,-0.945807,-0.945811,-0.945851,-0.945963,-0.946180,-0.946527,-0.947026,-0.947688,-0.948518,-0.949513,-0.950666,-0.951960,-0.953373,-0.954881,-0.956453,-0.958058,-0.959664,-0.961240,-0.962755,-0.964183,-0.965502,-0.966691,-0.967739,-0.968638,-0.969385,-0.969984,-0.970444,-0.970778,-0.971002,-0.971136,-0.971203,-0.971227,-0.971229,-0.971234,-0.971264,-0.971337,-0.971470,-0.971676,-0.971965,-0.972343,-0.972810,-0.973365,-0.974001,-0.974709,-0.975477,-0.976290,-0.977132,-0.977986,-0.978836,-0.979665,-0.980457,-0.981199,-0.981879,-0.982488,-0.983020,-0.983472,-0.983844,-0.984138,-0.984361,-0.984518,-0.984621,-0.984679,-0.984706,-0.984713,-0.984714,-0.984719,-0.984742,-0.984791,-0.984874,-0.984999,-0.985169,-0.985387,-0.985652,-0.985963,-0.986315,-0.986704,-0.987122,-0.987560,-0.988011,-0.988466,-0.988914,-0.989349,-0.989761,-0.990144,-0.990492,-0.990801,-0.991068,-0.991293,-0.991475,-0.991617,-0.991722,-0.991794,-0.991839,-0.991863,-0.991873,-0.991874,-0.991875,-0.991881,-0.991898,-0.991930,-0.991983,-0.992058,-0.992158,-0.992284,-0.992435,-0.992609,-0.992804,-0.993017,-0.993244,-0.993481,-0.993722,-0.993963,-0.994199,-0.994425,-0.994639,-0.994835,-0.995012,-0.995168,-0.995301,-0.995412,-0.995500,-0.995567,-0.995616,-0.995648,-0.995667,-0.995677,-0.995680,-0.995680,-0.995681,-0.995686,-0.995698,-0.995719,-0.995752,-0.995797,-0.995856,-0.995928,-0.996014,-0.996111,-0.996219,-0.996336,-0.996459,-0.996586,-0.996714,-0.996842,-0.996965,-0.997083,-0.997193,-0.997294,-0.997383,-0.997461,-0.997527,-0.997581,-0.997623,-0.997655,-0.997677,-0.997691,-0.997699,-0.997702,-0.997703,-0.997703,-0.997704,-0.997708,-0.997717,-0.997730,-0.997750,-0.997777,-0.997812,-0.997853,-0.997901,-0.997955,-0.998015,-0.998078,-0.998145,-0.998213,-0.998281,-0.998348,-0.998413,-0.998474,-0.998530,-0.998581,-0.998627,-0.998665,-0.998698,-0.998724,-0.998744,-0.998758,-0.998768,-0.998774,-0.998777,-0.998778,-0.998778,-0.998779,-0.998780,-0.998783,-0.998788,-0.998797,-0.998809,-0.998825,-0.998845,-0.998869,-0.998896,-0.998926,-0.998958,-0.998993,-0.999029,-0.999065,-0.999101,-0.999136,-0.999170,-0.999201,-0.999230,-0.999256,-0.999279,-0.999298,-0.999314,-0.999326,-0.999336,-0.999342,-0.999347,-0.999349,-0.999350,-0.999350,-0.999350,-0.999351,-0.999352,-0.999354,-0.999357,-0.999363,-0.999370,-0.999380,-0.999391,-0.999404,-0.999419,-0.999436,-0.999454,-0.999472,-0.999492,-0.999511,-0.999530,-0.999548,-0.99956
#e3 <- c(2.000000,1.499593,1.464228,1.434061,1.408209,1.385897,1.366458,1.349324,1.334012,1.320109,1.307266,1.295175,1.283566,1.272195,1.260830,1.249250,1.237232,1.224548,1.210956,1.196199,1.179999,1.162057,1.142050,1.119639,1.094473,1.066201,1.034489,0.999045,0.959648,0.916180,0.868662,0.817292,0.762466,0.704790,0.645074,0.584302,0.523575,0.464039,0.406811,0.352897,0.303129,0.258127,0.218273,0.183721,0.154419,0.130143,0.110537,0.095153,0.083486,0.075006,0.069174,0.065465,0.063373,0.062416,0.062141,0.062121,0.061955,0.061264,0.059691,0.056900,0.052577,0.046433,0.038208,0.027680,0.014671,-0.000937,-0.019193,-0.040066,-0.063432,-0.089069,-0.116655,-0.145775,-0.175935,-0.206579,-0.237120,-0.266971,-0.295574,-0.322431,-0.347129,-0.369355,-0.388906,-0.405689,-0.419716,-0.431088,-0.439987,-0.446654,-0.451379,-0.454482,-0.456300,-0.457179,-0.457465,-0.457492,-0.457582,-0.458036,-0.459130,-0.461112,-0.464196,-0.468558,-0.474328,-0.481593,-0.490385,-0.500682,-0.512405,-0.525419,-0.539539,-0.554528,-0.570117,-0.586007,-0.601887,-0.617448,-0.632397,-0.646471,-0.659446,-0.671149,-0.681459,-0.690312,-0.697700,-0.703663,-0.708289,-0.711705,-0.714068,-0.715559,-0.716372,-0.716714,-0.716789,-0.716800,-0.716939,-0.717381,-0.718285,-0.719785,-0.721989,-0.724975,-0.728789,-0.733445,-0.738922,-0.745167,-0.752098,-0.759603,-0.767548,-0.775783,-0.784145,-0.792469,-0.800593,-0.808366,-0.815653,-0.822341,-0.828342,-0.833598,-0.838078,-0.841781,-0.844733,-0.846985,-0.848609,-0.849692,-0.850338,-0.850657,-0.850764,-0.850776,-0.850803,-0.850952,-0.851317,-0.851979,-0.853005,-0.854445,-0.856328,-0.858666,-0.861452,-0.864660,-0.868247,-0.872155,-0.876313,-0.880642,-0.885055,-0.889466,-0.893787,-0.897937,-0.901843,-0.905442,-0.908686,-0.911539,-0.913983,-0.916013,-0.917639,-0.918886,-0.919791,-0.920399,-0.920765,-0.920948,-0.921012,-0.921020,-0.921033,-0.921109,-0.921301,-0.921653,-0.922202,-0.922974,-0.923985,-0.925239,-0.926734,-0.928452,-0.930370,-0.932456,-0.934671,-0.936972,-0.939314,-0.941649,-0.943932,-0.946120,-0.948175,-0.950064,-0.951763,-0.953252,-0.954523,-0.955574,-0.956412,-0.957050,-0.957507,-0.957810,-0.957988,-0.958074,-0.958101,-0.958103,-0.958114,-0.958164,-0.958281,-0.958489,-0.958805,-0.959242,-0.959809,-0.960506,-0.961329,-0.962268,-0.963311,-0.964438,-0.965628,-0.966857,-0.968102,-0.969337,-0.970538,-0.971683,-0.972753,-0.973731,-0.974605,-0.975366,-0.976010,-0.976538,-0.976954,-0.977265,-0.977485,-0.977626,-0.977705,-0.977739,-0.977748,-0.977749,-0.977759,-0.977795,-0.977871,-0.977998,-0.978186,-0.978440,-0.978764,-0.979156,-0.979615,-0.980133,-0.980703,-0.981315,-0.981955,-0.982613,-0.983274,-0.983925,-0.984555,-0.985151,-0.985704,-0.986205,-0.986650,-0.987033,-0.987354,-0.987614,-0.987816,-0.987964,-0.988065,-0.988128,-0.988160,-0.988173,-0.988175,-0.988176,-0.988185,-0.988211,-0.988261,-0.988340,-0.988453,-0.988601,-0.988787,-0.989009,-0.989265,-0.989552,-0.989864,-0.990195,-0.990540,-0.990891,-0.991241,-0.991584,-0.991912,-0.992221,-0.992505,-0.992761,-0.992985,-0.993176,-0.993334,-0.993460,-0.993556,-0.993625,-0.993670,-0.993697,-0.993709,-0.993713,-0.993714,-0.993715,-0.993723,-0.993742,-0.993774,-0.993823,-0.993890,-0.993977,-0.994084,-0.994209,-0.994352,-0.994510,-0.994680,-0.994860,-0.995045,-0.995232,-0.995417,-0.995597,-0.995767,-0.995926,-0.996072,-0.996201,-0.996313,-0.996408,-0.996485,-0.996545,-0.996590,-0.996622,-0.996641,-0.996652,-0.996657,-0.996658,-0.996658,-0.996660,-0.996666,-0.996679,-0.996699,-0.996729,-0.996769,-0.996820,-0.996880,-0.996951,-0.997030,-0.997117,-0.997210,-0.997307,-0.997406,-0.997505,-0.997603,-0.997697,-0.997785,-0.997867,-0.997941,-0.998006,-0.998061,-0.998108,-0.998145,-0.998174,-0.998195,-0.998209,-0.998217,-0.998221,-0.998222,-0.998223,-0.998223,-0.998225,-0.998229,-0.998238,-0.998251,-0.998269,-0.998292,-0.998322,-0.998356,-0.998396,-0.998440,-0.998488,-0.998538,-0.998590,-0.998643,-0.998695,-0.998746,-0.998795,-0.998841,-0.998883,-0.998920,-0.998952,-0.998980,-0.999003,-0.999021,-0.999034,-0.999043,-0.999050,-0.999053,-0.999054,-0.999055,-0.999055,-0.999055,-0.999057,-0.999060,-
### e1-e3は先頭の数値が間違っている



png("graph1.png")

plot(t,u_1,type="l",col="red", ylim=c(-2,8),ann=F)
par(new=T)
plot(t,u_2,type="l",col="green", ylim=c(-2,8),ann=F)
par(new=T)
plot(t,u_3,type="l",col="blue", ylim=c(-2,8),ann=F)

dev.off()


png("graph2.png")

plot(t,e_1,type="l",col="red", ylim=c(-1,2),ann=F)
par(new=T)
plot(t,e_2,type="l",col="green", ylim=c(-1,2),ann=F)
par(new=T)
plot(t,e_3,type="l",col="blue", ylim=c(-1,2),ann=F)

dev.off()
